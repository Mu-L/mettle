/*!
 * Mettle.js v0.9.0
 * (c) 2021-2025 maomincoding
 * Released under the MIT License.
 */
function e(e){const t=Object.create(null),n=e.split(",");for(let e=0;e<n.length;e++)t[n[e]]=!0;return function(e){return t[e]}}const t=e("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),n=e("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function o(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)}const r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function i(e){return Object.prototype.toString.call(e).match(/\[object (.+?)\]/)[1].toLowerCase()}function l(e){return null==e}function s(e,t){return e.tag===t.tag&&e.key===t.key}function c(e,t){return e.hasOwnProperty(t)}function a(e){return!(!e||"object"!==i(e))&&(c(e,"tag")&&c(e,"props")&&c(e,"children")&&c(e,"key"))}function f(e){return Array.isArray(e)?function(e){return e.every(a)}(e):a(e)}function u(e){console.warn(`[Mettle.js warn]: ${e}`)}function p(e,t){Object.assign(e.style,t)}function d(e,t,n){const o=t.slice(2).toLowerCase();"function"==typeof n&&e.addEventListener(o,n)}function m(e,t,n){const o=t.slice(2).toLowerCase();"function"==typeof n&&e.removeEventListener(o,n)}function h(e,t,n){if(o(t)){const o="http://www.w3.org/1999/xlink";e.setAttributeNS(o,t,n.toString())}else"boolean"!=typeof n?e.setAttribute(t,n.toString()):n?e.setAttribute(t,""):e.removeAttribute(t)}function g(e,t){var n;o(t)?e.removeAttributeNS("http://www.w3.org/1999/xlink",o(n=t)?n.slice(6,n.length):""):e.removeAttribute(t)}function b(e){switch(!0){case t(e):return document.createElement(e);case n(e):return o=function(e){return n(e)?"svg":"math"===e?"math":void 0}(e),i=e,document.createElementNS(r[o],i);case"fragment"===e:return document.createDocumentFragment();case"comment"===e||"null"===e:return document.createComment(e);default:return document.createElement(e)}var o,i}const y="0.9.0",w=["$ref","$once","$memo"];let v=new WeakMap;const k=new WeakMap;function j(e,t){t.textContent=e}function M(e,t){const n=e.children,o=t.children,r=i(o);if("array"===r)for(let e=0;e<o.length;e++){const t=o[e],r=n[e];a(t)&&(t.el=r.el,M(r,t))}else"object"===r&&(o.el=n.el)}function S(e,t,n){const{tag:o,props:r,children:s}=e;if(!l(o)){const c=i(o);if("string"===c){const c=b(o);if(e.el=c,!l(r)){const e=Object.keys(r);for(let t=0;t<e.length;t++){const n=e[t],o=r[n],l=i(o);n.startsWith("on")&&d(c,n,o),"function"===l||"key"===n||w.includes(n)||h(c,n,o),"style"===n&&"object"===l&&p(c,o),n===w[0]&&"object"===l&&k.set(o,c)}}if(!l(s))if(f(s)){const e=i(s);if("array"===e)for(let e=0;e<s.length;e++){const t=s[e];a(t)&&S(t,c)}else"object"===e&&S(s,c)}else c&&j(s,c);if(n)t.insertBefore(c,n);else{if(!t)return c;t.appendChild(c)}}else if("function"===c){const e={content:o,setData:A.bind(o),props:r},n=o.call(o,e);o.template=n;const i=n();S(i,t),v.set(o,i)}}}function C(e,t,n){if((!e.props||!e.props.hasOwnProperty(w[1]))&&function(e,t){return"function"!==i(t.tag)&&"function"!==i(e.tag)}(e,t))if(s(e,t)){const o=t.el=e.el,r=e.props||{},c=t.props||{},u={},b=Object.keys(c),y=Object.keys(r),v=new Set(b);for(let e=0;e<b.length;e++)u[b[e]]=!0;for(let e=0;e<y.length;e++)u[y[e]]=!0;const k=Object.keys(u);for(let e=0;e<k.length;e++){const t=k[e],n=c[t],s=r[t];if(n===s)continue;if(l(n)){g(o,t);continue}const a=i(n),f="function"===a,u="style"===t;if(f){n.toString()!==s.toString()&&(m(o,t,s),d(o,t,n));continue}if(u&&"object"===a){p(o,n);continue}"key"!==t&&!w.includes(t)&&!f&&h(o,t,n)}for(let e=0;e<y.length;e++){const t=y[e];v.has(t)||g(o,t)}if(e.props&&e.props.hasOwnProperty(w[2])&&!e.props.$memo[0]&&e.props.$memo[1]===n)return void M(e,t);const A=e.children,L=t.children;"array"===i(A)&&"array"===i(L)?function(e,t,n,o){const r=t.length;let i=0,l=e.length-1,c=r-1;for(;i<=l&&i<=c&&s(e[i],t[i]);)C(e[i],t[i],o),i++;for(;i<=l&&i<=c&&s(e[l],t[c]);)C(e[l],t[c],o),l--,c--;if(i>l){if(i<=c){const e=c+1,o=e<r?t[e].el:null;for(;i<=c;)n.insertBefore(S(t[i]),o),i++}}else if(i>c)for(;i<=l;)n.removeChild(e[i].el),i++;else{const a=i,f=i,u=new Map;for(i=f;i<=c;i++){const e=t[i];null!=e.key&&u.set(e.key,i)}let p,d=0;const m=c-f+1;let h=!1,g=0;const b=new Array(m);for(i=0;i<m;i++)b[i]=0;for(let r=a;r<=l;r++){if(d>=m){n.removeChild(e[r].el);continue}let i;if(null!==e[r].key)i=u.get(e[r].key);else for(p=f;p<=c;p++)if(0===b[p-f]&&s(e[r],t[p])){i=p;break}void 0===i?n.removeChild(e[r].el):(b[i-f]=r+1,i>g?g=i:h=!0,C(e[r],t[i],o),d++)}const y=h?function(e){const t=e.slice(),n=[0];let o,r,i,l,s;const c=e.length;for(o=0;o<c;o++){const c=e[o];if(0!==c){if(r=n[n.length-1],e[r]<c){t[o]=r,n.push(o);continue}for(i=0,l=n.length-1;i<l;)s=(i+l)/2|0,e[n[s]]<c?i=s+1:l=s;c<e[n[i]]&&(i>0&&(t[o]=n[i-1]),n[i]=o)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=t[l];return n}(b):[];p=y.length-1;for(let e=m-1;e>=0;e--){const o=e+f,i=o+1<r?t[o+1].el:null;0===b[e]?n.insertBefore(S(t[o]),i):h&&(p<0||e!==y[p]?n.insertBefore(t[o].el,i):p--)}}}(A,L,o,n):a(A)&&a(L)?C(A,L,n):f(A)||f(L)||A===L||j(L,o)}else{const n=e.el.parentNode,o=e.el.nextSibling;n.removeChild(e.el),S(t,n,o)}}async function A(e,t,n){if("function"==typeof e&&"undefined"!=typeof Promise)try{await Promise.resolve(e());const o=t||this,r=o.template();C(v.get(o),r,n),v.set(o,r)}catch(e){u(e.message)}}function L(e,t){const n=e.tag,o={content:n,setData:A.bind(n),props:e.props},r=n.call(n,o);n.template=r;const i=r(),l=function(e){if("string"==typeof e){const t=document.querySelector(e);if(!t){let t=null;return e.startsWith("#")?(t=document.createElement("div"),t.setAttribute("id",e.substring(1,e.length))):e.startsWith(".")?(t=document.createElement("div"),t.setAttribute("class",e.substring(1,e.length))):u(`Failed to mount app: mount target selector "${e}" returned null.`),document.body.insertAdjacentElement("afterbegin",t),t}return t}return e instanceof HTMLElement?e:window.ShadowRoot&&e instanceof window.ShadowRoot&&"closed"===e.mode?(u('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(t);S(i,l),v.set(n,i),P=l,D()}let O=[],x=0,E=0;function T(e=null){null!==e&&("function"==typeof e?O.push(e):u("The parameter of onMounted is not a function!"))}function D(){if(O.length>0)for(let e=0,t=O.length;e<t;e++)O[e]&&O[e]();E=x,x=0,O=[]}let $=[];function B(e=null){null!==e&&("function"==typeof e?(x+=1,$.push(e)):u("The parameter of onUnmounted is not a function!"))}let P=Object.create(null);function W(e){!function(){if($.length>0){for(let e=0;e<E;e++)$[e]&&$[e]();$.splice(0,E)}E=x}(),P.innerHTML="",v=null,v=new WeakMap;const t={content:e,setData:A.bind(e)},n=e.call(e,t);e.template=n;const o=n();S(o,P),v.set(e,o),D()}export{L as createApp,k as domInfo,T as onMounted,B as onUnmounted,W as resetView,A as setData,y as version};
