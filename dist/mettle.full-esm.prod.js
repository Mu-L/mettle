/*!
 * Mettle.js v0.5.0
 * (c) 2021-2025 maomincoding
 * Released under the MIT License.
 */
const t=(e,n,o,r)=>{let i;n[0]=0;for(let l=1;l<n.length;l++){const s=n[l++],c=n[l]?(n[0]|=s?1:2,o[n[l++]]):n[++l];3===s?r[0]=c:4===s?r[1]=Object.assign(r[1]||{},c):5===s?(r[1]=r[1]||{})[n[++l]]=c:6===s?r[1][n[++l]]+=c+"":s?(i=e.apply(c,t(e,c,o,["",null])),r.push(i),c[0]?n[0]|=2:(n[l-2]=0,n[l]=i)):r.push(c)}return r},e=new Map,n=function(n){let o=e.get(this);return o||(o=new Map,e.set(this,o)),o=t(this,o.get(n)||(o.set(n,o=function(t){let e,n,o=1,r="",i="",l=[0];const s=t=>{1===o&&(t||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?l.push(0,t,r):3===o&&(t||r)?(l.push(3,t,r),o=2):2===o&&"..."===r&&t?l.push(4,t,0):2===o&&r&&!t?l.push(5,0,!0,r):o>=5&&((r||!t&&5===o)&&(l.push(o,0,r,n),o=6),t&&(l.push(o,t,0,n),o=6)),r=""};for(let c=0;c<t.length;c++){c&&(1===o&&s(),s(c));for(let a=0;a<t[c].length;a++)e=t[c][a],1===o?"<"===e?(s(),l=[l],o=3):r+=e:4===o?"--"===r&&">"===e?(o=1,r=""):r=e+r[0]:i?e===i?i="":r+=e:'"'===e||"'"===e?i=e:">"===e?(s(),o=1):o&&("="===e?(o=5,n=r,r=""):"/"===e&&(o<5||">"===t[c][a+1])?(s(),3===o&&(l=l[0]),o=l,(l=l[0]).push(2,0,o),o=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(s(),o=2):r+=e),3===o&&"!--"===r&&(o=4,l=l[0])}return s(),l}(n)),o),arguments,[]),o.length>1?o:o[0]}.bind((function(t,e,n){let o=null,r=null,i=null;for(r in e)"key"===r&&(o=e[r]);return arguments.length>2&&(i=arguments.length>3?Array.prototype.slice.call(arguments,2):n),{tag:t,props:e,children:i,key:o,el:null}}));function o(t){const e=Object.create(null),n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return function(t){return e[t]}}const r=o("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),i=o("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function l(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)}const s={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function c(t){return Object.prototype.toString.call(t).match(/\[object (.+?)\]/)[1].toLowerCase()}function a(t){return null==t}function u(t,e){return t.tag===e.tag&&t.key===e.key}function f(t,e){return t.hasOwnProperty(e)}function p(t){if(t)return f(t,"tag")&&f(t,"props")&&f(t,"children")&&f(t,"key")&&f(t,"el")}function h(t){return Array.isArray(t)?function(t){return t.every(p)}(t):p(t)}function m(t){console.warn(`[Mettle.js warn]: ${t}`)}function g(t,e){Object.assign(t.style,e)}function d(t,e,n){const o=e.slice(2).toLowerCase();"function"==typeof n&&t.addEventListener(o,n)}function b(t,e,n){const o=e.slice(2).toLowerCase();"function"==typeof n&&t.removeEventListener(o,n)}function y(t,e,n){if(l(e)){const o="http://www.w3.org/1999/xlink";t.setAttributeNS(o,e,n.toString())}else"boolean"!=typeof n?t.setAttribute(e,n.toString()):n?t.setAttribute(e,""):t.removeAttribute(e)}function w(t,e){var n;l(e)?t.removeAttributeNS("http://www.w3.org/1999/xlink",l(n=e)?n.slice(6,n.length):""):t.removeAttribute(e)}function v(t){switch(!0){case r(t):return document.createElement(t);case i(t):return e=function(t){return i(t)?"svg":"math"===t?"math":void 0}(t),n=t,document.createElementNS(s[e],n);case"fragment"===t||"component"===t:return document.createDocumentFragment();case"comment"===t||"null"===t:return document.createComment(t);default:return document.createElement(t)}var e,n}const k="0.5.0",j=["$ref","$is","$once","$memo"],M=new WeakMap;let S=new WeakMap;function A(t,e){e.textContent=t}function C(t,e){const n=t.children,o=e.children,r=c(o);if("array"===r)for(let t=0;t<o.length;t++){const e=o[t],r=n[t];p(e)&&(e.el=r.el,C(r,e))}else"object"===r&&(o.el=n.el)}function O(t,e,n){const{tag:o,props:r,children:i}=t;if(!a(o)){const l=v(o);if(t.el=l,!a(r)){const t=Object.keys(r);for(let e=0;e<t.length;e++){const n=t[e],o=r[n],i=c(o);if(n.startsWith("on")&&d(l,n,o),"function"===i||"key"===n||j.includes(n)||y(l,n,o),"style"===n&&"object"===i&&g(l,o),n===j[1]&&"object"===i){const t=o.template();O(t,l),S.set(o,t)}n===j[0]&&"object"===i&&M.set(o,l)}}if("component"!==o&&!a(i))if(h(i)){const t=c(i);if("array"===t)for(let t=0;t<i.length;t++){const e=i[t];p(e)&&O(e,l)}else"object"===t&&O(i,l)}else l&&A(i,l);if(n)e.insertBefore(l,n);else{if(!e)return l;e.appendChild(l)}}}function L(t,e,n){if((!t.props||!t.props.hasOwnProperty(j[2]))&&function(t,e){return"component"!==e.tag&&"component"!==t.tag}(t,e))if(u(t,e)){const o=e.el=t.el,r=t.props||{},i=e.props||{},l={},s=Object.keys(i),f=Object.keys(r),m=new Set(s);for(let t=0;t<s.length;t++)l[s[t]]=!0;for(let t=0;t<f.length;t++)l[f[t]]=!0;const v=Object.keys(l);for(let t=0;t<v.length;t++){const e=v[t],n=i[e],l=r[e];if(n===l)continue;if(a(n)){w(o,e);continue}const s=c(n),u="function"===s,f="style"===e;if(u){n.toString()!==l.toString()&&(b(o,e,l),d(o,e,n));continue}if(f&&"object"===s){g(o,n);continue}"key"!==e&&!j.includes(e)&&!u&&y(o,e,n)}for(let t=0;t<f.length;t++){const e=f[t];m.has(e)||w(o,e)}if(t.props&&t.props.hasOwnProperty(j[3])&&!t.props.$memo[0]&&t.props.$memo[1]===n)return void C(t,e);const k=t.children,M=e.children;"array"===c(k)&&"array"===c(M)?function(t,e,n,o){const r=e.length;let i=0,l=t.length-1,s=r-1;for(;i<=l&&i<=s&&u(t[i],e[i]);)L(t[i],e[i],o),i++;for(;i<=l&&i<=s&&u(t[l],e[s]);)L(t[l],e[s],o),l--,s--;if(i>l){if(i<=s){const t=s+1,o=t<r?e[t].el:null;for(;i<=s;)n.insertBefore(O(e[i]),o),i++}}else if(i>s)for(;i<=l;)n.removeChild(t[i].el),i++;else{const c=i,a=i,f=new Map;for(i=a;i<=s;i++){const t=e[i];null!=t.key&&f.set(t.key,i)}let p,h=0;const m=s-a+1;let g=!1,d=0;const b=new Array(m);for(i=0;i<m;i++)b[i]=0;for(let r=c;r<=l;r++){if(h>=m){n.removeChild(t[r].el);continue}let i;if(null!==t[r].key)i=f.get(t[r].key);else for(p=a;p<=s;p++)if(0===b[p-a]&&u(t[r],e[p])){i=p;break}void 0===i?n.removeChild(t[r].el):(b[i-a]=r+1,i>d?d=i:g=!0,L(t[r],e[i],o),h++)}const y=g?function(t){const e=t.slice(),n=[0];let o,r,i,l,s;const c=t.length;for(o=0;o<c;o++){const c=t[o];if(0!==c){if(r=n[n.length-1],t[r]<c){e[o]=r,n.push(o);continue}for(i=0,l=n.length-1;i<l;)s=(i+l)/2|0,t[n[s]]<c?i=s+1:l=s;c<t[n[i]]&&(i>0&&(e[o]=n[i-1]),n[i]=o)}}for(i=n.length,l=n[i-1];i-- >0;)n[i]=l,l=e[l];return n}(b):[];p=y.length-1;for(let t=m-1;t>=0;t--){const o=t+a,i=o+1<r?e[o+1].el:null;0===b[t]?n.insertBefore(O(e[o]),i):g&&(p<0||t!==y[p]?n.insertBefore(e[o].el,i):p--)}}}(k,M,o,n):p(k)&&p(M)?L(k,M,n):h(k)||h(M)||k===M||A(M,o)}else{const n=t.el.parentNode,o=t.el.nextSibling;n.removeChild(t.el),O(e,n,o)}}async function x(t,e,n){if("function"==typeof t&&"undefined"!=typeof Promise)try{await Promise.resolve(t());const o=e||this,r=o.template();L(S.get(o),r,n),S.set(o,r)}catch(t){m(t.message)}}let E=[],$=0,T=0;function B(t=null){null!==t&&("function"==typeof t?E.push(t):m("The parameter of onMounted is not a function!"))}function P(){if(E.length>0)for(let t=0,e=E.length;t<e;t++)E[t]&&E[t]();T=$,$=0,E=[]}let W=[];function D(t=null){null!==t&&("function"==typeof t?($+=1,W.push(t)):m("The parameter of onUnmounted is not a function!"))}let N=Object.create(null);function q(t){!function(){if(W.length>0){for(let t=0;t<T;t++)W[t]&&W[t]();W.splice(0,T)}T=$}(),N.innerHTML="",S=null,S=new WeakMap;const e=t.template();O(e,N),S.set(t,e),P()}function F(t,e){"function"==typeof t&&(e=t,t=Object.create(null));class n{template;static instance;constructor(){const n={content:this,setData:x.bind(this)},o=e.call(this,n);this.template=o;const r=o();if(t.mount){const e=function(t){if("string"==typeof t){const e=document.querySelector(t);if(!e){let e=null;return t.startsWith("#")?(e=document.createElement("div"),e.setAttribute("id",t.substring(1,t.length))):t.startsWith(".")?(e=document.createElement("div"),e.setAttribute("class",t.substring(1,t.length))):m(`Failed to mount app: mount target selector "${t}" returned null.`),document.body.insertAdjacentElement("afterbegin",e),e}return e}return t instanceof HTMLElement?t:window.ShadowRoot&&t instanceof window.ShadowRoot&&"closed"===t.mode?(m('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(t.mount);O(r,e),S.set(this,r),N=e,P()}}static getInstance(){return this.instance||(this.instance=new n),this.instance}}return n.getInstance()}export{F as defineComponent,M as domInfo,n as html,B as onMounted,D as onUnmounted,q as resetView,x as setData,k as version};
